var t,e={};const s=new((t=class{constructor(t=null){this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){let t=[];for(let e=0;e<4;e++)t.push([0,0,0,0]);return t}moveLeft(){let t=this.board.map(t=>[...t]),e=0;for(let t=0;t<this.board.length;t++){let s=this.board[t].filter(t=>0!==t),r=[],o=0;for(;o<s.length;)if(s[o]===s[o+1]){let t=2*s[o];r.push(t),e+=t,o+=2}else r.push(s[o]),o+=1;for(;r.length<4;)r.push(0);this.board[t]=r}this.board.some((e,s)=>e.some((e,r)=>e!==t[s][r]))&&(this.addRandomTile(),this.score+=e),this.board.some(t=>t.includes(2048))&&(this.status="win")}moveRight(){let t=this.board.map(t=>[...t]),e=0;for(let t=0;t<this.board.length;t++){let s=[...this.board[t]].reverse().filter(t=>0!==t),r=[],o=0;for(;o<s.length;)if(s[o]===s[o+1]){let t=2*s[o];r.push(t),e+=t,o+=2}else r.push(s[o]),o+=1;for(;r.length<4;)r.push(0);this.board[t]=r.reverse()}this.board.some((e,s)=>e.some((e,r)=>e!==t[s][r]))&&(this.addRandomTile(),this.score+=e),this.board.some(t=>t.includes(2048))&&(this.status="win")}moveUp(){let t=this.board.map(t=>[...t]),e=0;for(let t=0;t<4;t++){let s=[];for(let e=0;e<4;e++)s.push(this.board[e][t]);let r=s.filter(t=>0!==t),o=[],a=0;for(;a<r.length;)if(r[a]===r[a+1]){let t=2*r[a];o.push(t),e+=t,a+=2}else o.push(r[a]),a+=1;for(;o.length<4;)o.push(0);for(let e=0;e<4;e++)this.board[e][t]=o[e]}this.board.some((e,s)=>e.some((e,r)=>e!==t[s][r]))&&(this.addRandomTile(),this.score+=e),this.board.some(t=>t.includes(2048))&&(this.status="win")}moveDown(){let t=this.board.map(t=>[...t]),e=0;for(let t=0;t<4;t++){let s=[];for(let e=0;e<4;e++)s.push(this.board[e][t]);let r=s.filter(t=>0!==t),o=[],a=r.length-1;for(;a>=0;)if(r[a]===r[a-1]){let t=2*r[a];o.unshift(t),e+=t,a-=2}else o.unshift(r[a]),a-=1;for(;o.length<4;)o.unshift(0);for(let e=0;e<4;e++)this.board[e][t]=o[e]}this.board.some((e,s)=>e.some((e,r)=>e!==t[s][r]))&&(this.addRandomTile(),this.score+=e),this.board.some(t=>t.includes(2048))&&(this.status="win")}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:r}=t[e],o=.9>Math.random()?2:4;this.board[s][r]=o}}isGameOver(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}restart(){this.start()}}).__esModule?t.default:t),r=document.querySelector(".game-field tbody"),o=document.querySelector(".game-score"),a=document.querySelectorAll(".message-container .message"),i=document.querySelector(".message-lose"),l=document.querySelector(".message-win"),d=document.querySelector(".message-start"),h=document.querySelector(".button.start");function n(){r.innerHTML="";let t=s.getState();for(let e=0;e<t.length;e++){let s=document.createElement("tr");s.classList.add("field-row");for(let r=0;r<t[e].length;r++){let o=t[e][r],a=document.createElement("td");a.classList.add("field-cell"),0!==o&&(a.textContent=o,a.classList.add(`field-cell--${o}`)),s.appendChild(a)}r.appendChild(s)}o.textContent=s.getScore();let e=s.getStatus();a.forEach(t=>t.classList.add("hidden")),"win"===e?l.classList.remove("hidden"):"lose"===e?i.classList.remove("hidden"):"idle"===e?(d.classList.remove("hidden"),h.textContent="Start",h.classList.add("start"),h.classList.remove("restart")):"playing"===e&&(h.textContent="Restart",h.classList.remove("start"),h.classList.add("restart"))}n(),document.addEventListener("keydown",t=>{"playing"===s.getStatus()&&("ArrowUp"===t.key?s.moveUp():"ArrowDown"===t.key?s.moveDown():"ArrowRight"===t.key?s.moveRight():"ArrowLeft"===t.key&&s.moveLeft(),s.isGameOver()&&(s.status="lose"),n())}),h.addEventListener("click",()=>{s.start(),n(),h.textContent="Restart",h.classList.remove("start"),h.classList.add("restart")});
//# sourceMappingURL=index.b54d8b52.js.map
